@model Web.ViewModels.CompanyExportSettingsViewModel
@{
    Layout = null;
}

<form id="paymentsPartialForm" action="/api/export/customcsv" method="post">
    <fieldset>
        <input type="hidden" name="CompanyId" value="@Model.CompanyId" />

        <div class="form-group mb-3">
            <label asp-for="Title"></label>
            <input class="form-control" asp-for="Title" />
        </div>
        <div class="form-group mb-3 form-check">
            <input type="checkbox" value="@Model.ShowEmptyRows" name="ShowEmptyRows:boolean" id="ShowEmptyRows" data-val="true" />
            <label asp-for="ShowEmptyRows" class="form-check-label"></label>
        </div>
        @foreach(var field in Model.Fields) {
        <div class="form-row mb-3">
            <div class="col">
                <label asp-for="@field.Name"></label>
                <input class="form-control" name="Fields[][Name]" value="@field.Name" />
            </div>
            <div class="col">
                <label asp-for="@field.Value"></label>
                <input class="form-control" name="Fields[][Value]" value="@field.Value" />
            </div>
        </div>
        }
    </fieldset>
</form>
<script type="text/javascript">
    $(document).ready(e => {
        $('#paymentsPartialForm').on('submit', e => {
            e.preventDefault();
            var $target = $(e.target);
            $target.ajaxSubmit({}, (form, data, status, jqXHR, opt) => {
                if (status === 'success') {
                    window.modal.modal('hide');
                }
            });
        });

    });

    function generateRandomDate() {
        var from = $('#paymentsPartialForm input[name=DateFrom]').val();
        var to = $('#paymentsPartialForm input[name=DateTo]').val();

        $('#paymentsPartialForm table input[type=date]').each((index, element) => {
            var d = $.fn.randomDate(new Date(from), new Date(to));
            $(element).val(d.toISOString().slice(0, 10));
        });
    }
</script>